ngx_addon_name=appguard_nginx_module

NGX_APPGUARD_SRCS="                                 \
    $ngx_addon_dir/src/appguard_nginx_module.c      \
    "
NGX_APPGUARD_DEPS="                                 \
    $ngx_addon_dir/src/appguard_nginx_module.h      \
    "

APPGUARD_PROTO_SRCS="                               \
    $ngx_addon_dir/proto/appguard.h                 \
    $ngx_addon_dir/proto/appguard.pb.cc             \
    $ngx_addon_dir/proto/appguard.inner.utils.cpp   \
    $ngx_addon_dir/proto/appguard.grpc.pb.c         \
    "
APPGUARD_PROTO_DEPS="                               \
    $ngx_addon_dir/proto/appguard.cpp               \
    $ngx_addon_dir/proto/appguard.pb.h              \
    $ngx_addon_dir/proto/appguard.inner.utils.h     \
    $ngx_addon_dir/proto/appguard.grpc.pb.h         \
    "

if test -n "$ngx_module_link"; then
    ngx_module_type=HTTP
    ngx_module_name=$ngx_addon_name
    ngx_module_incs="                               \
        $ngx_module_incs                            \
        $ngx_addon_dir/proto                        \
    "
    ngx_module_deps="                               \
        $APPGUARD_PROTO_DEPS                        \
        $NGX_APPGUARD_DEPS                          \
    "
    ngx_module_srcs="                               \
        $APPGUARD_PROTO_SRCS                        \
        $NGX_APPGUARD_SRCS                          \
    "

    . auto/module
else
    HTTP_MODULES="$HTTP_MODULES $ngx_addon_name"
    NGX_ADDON_SRCS="                               \
        $APPGUARD_PROTO_SRCS                       \
        $NGX_APPGUARD_SRCS                         \
    "
    NGX_ADDON_DEPS="                               \
        $APPGUARD_PROTO_DEPS                       \
        $NGX_APPGUARD_DEPS                         \
    "
fi